---
title: "Tuolumne River"
author: "[Sadie Gill](mailto:sgill@flowwest.com), [Mark Tompkins](mailto:mtompkins@flowwest.com)"
date: "April 10, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
library(tidyverse)
library(readxl)
library(cvpiaHabitat)
```

## Future Data Improvements
[Future data improvement bullets]

## Instream Spawning and Rearing Habiat

**Data Source:**
[Flo2D model by Stillwater 2014](https://s3-us-west-2.amazonaws.com/cvpiahabitat-r-package/cvpia-sit-model-inputs/Stillwater2010_Tuolumne_P-2299-075_71_DP_FLA_AttC_StudyRept_IFIM_AppA-H_140428.pdf)

Instream spawning and rearing habitat for Fall Run Chinook Salmon and Steelhead in the Tuolumne River is based on data from [data source description]. The [DWR FERC instream spawning and rearing habitat data] was provided by [Mark Gard](mailto:mark_gard@fws.gov) from the U.S. Fish and Wildlife Service in a spreadsheet (see '~/cvpiaHabitat/data-raw/mark_gard_data/IFIMWUA.xlsx'). Mark Gard instructed us to use cells A2:H32 in the 'Tuolumne' tab within his 'IFIMWUA.xlsx'.

Units are in square feet per 1000 feet.


```{r, echo=FALSE}
# # merced_river_instream <-
# tuolumne_river_instream <- read_excel('data-raw/mark_gard_data/IFIMWUA.xlsx', 
#                                       range = "A2:H32", sheet = 'Tuolumne') %>% 
#   mutate(watershed = 'Tuolumne River') %>% 
#   select(flow_cfs = `Simulated\nDischarge\n(cfs)`, FR_spawn_wua = `Chinook\nSpawning`,
#          FR_fry_wua = `Chinook\nFry`, FR_juv_wua = `Chinook\nJuvenile`, 
#          ST_spawn_wua = `O. mykiss\nSpawning`, ST_fry_wua = `O. mykiss\nFry`, 
#          ST_juv_wua = `O. mykiss\nJuvenile`, ST_adult_wua = `O. mykiss\nAdult`, watershed)
# 
# tuolumne_river_instream
# devtools::use_data(tuolumne_river_instream, overwrite = TRUE)
```

### Spawning WUA 
[description]

#### Spawning WUA Plot
The following plot shows the weighted usable spawning area in square feet per thousand feet of river for Fall Run Chinook Salmon and Steelhead. These area per length rates are multiplied by the total spawning reach length mapped by the SIT. 

``` {r,echo=FALSE}
tuolumne_river_instream %>% 
    gather(Species, wua, -flow_cfs, -watershed)  %>% 
    filter(!is.na(wua), Species != 'FR_fry_wua',Species != 'FR_juv_wua',Species != 'ST_adult_wua',Species != 'ST_juv_wua',Species != 'ST_fry_wua') %>% 
    ggplot(aes(x = flow_cfs , y = wua, color = Species)) +
    geom_line() +
    labs(x = 'Flow (cfs)', y = 'WUA (sqft/1000ft)') + 
    theme_minimal() + 
    scale_color_manual(values = c('#d95f02','#7570b3'))

```

### Rearing WUA
The fry and juvenile instream rearing habitat weighted usable areas for Fall Run Chinook Salmon and Steelhead in the Tuolumne River are provided by Mark Gard (see '~/cvpiaHabitat/data-raw/mark_gard_data/IFIMWUA.xlsx'). 

#### Rearing WUA Plot

``` {r,echo=FALSE}
tuolumne_river_instream %>% 
  rename(`Fall Run (Fry)` = FR_fry_wua, `Fall Run (Juvenile)` = FR_juv_wua, `Steelhead (Fry)` = ST_fry_wua, `Steelhead (Juvenile)` = ST_juv_wua) %>% 
  gather(Lifestage, wua, -flow_cfs, -watershed)  %>% 
  filter(!is.na(wua), Lifestage != 'FR_spawn_wua', Lifestage != 'ST_spawn_wua', Lifestage != 'ST_adult_wua') %>%
  #mutate(lifestage = ifelse(lifestage == 'FR_fry_wua', 'fry', 'juvenile')) %>% 
  ggplot(aes(x = flow_cfs , y = wua, color = Lifestage)) +
  geom_line() +
  labs(x = 'Flow (cfs)', y = 'WUA (sqft/1000ft)') + 
  theme_minimal() + 
  scale_color_manual(values = c('#d95f02','#7570b3','#56B4E9','#009E73'))
```


